<body>
  <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->

  <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-app.js"></script>

  <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
  <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-analytics.js"></script>

  <!-- Add Firebase products that you want to use -->
  <!-- <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-auth.js"></script> -->
  <!-- <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-firestore.js"></script> -->
  <script src="https://www.gstatic.com/firebasejs/7.8.0/firebase-database.js"></script>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyDQ3gaHvcFpEkusY-VAS2sgUru_terdUVA",
    authDomain: "hitmeservermate.firebaseapp.com",
    databaseURL: "https://hitmeservermate.firebaseio.com",
    projectId: "hitmeservermate",
    storageBucket: "hitmeservermate.appspot.com",
    messagingSenderId: "169795236310",
    appId: "1:169795236310:web:3a18388d3336351bd7b477"
  };
  firebase.initializeApp(firebaseConfig);

  var defaultDatabase = firebase.database();

//Get available moves once
var moveRef = defaultDatabase.ref("moves/");
moveRef.once("value", function(data) {
  var values = data.val();
  console.log(typeof values);
  console.log(values);

   for (var property in values) {
     console.log(Object.getOwnPropertyDescriptor(values,property).value.damage);
   }

}, function (error) {
   console.log("Error: " + error.code);
});

/*
====================================
CODE THAT GETS POSE OF PLAYER B
{----INSERT HERE----}
====================================
*/

//Subscription to notify when number of moves changed
var playerMoves = defaultDatabase.ref("players/");
playerMoves.on("child_changed", function(data){
  var moveNumber = data.val();
  console.log("Number of moves: "+moveNumber); 
}, function(error){
  console.log("Error: "+error.code);
})

// Testing changes

//Get health value of player A
var playerA = defaultDatabase.ref("players/A");
playerA.once("value", function(data){
  var health = data.val();
  console.log("Health: "+health.health);
}, function(error){
  console.log("Error: "+ error.code);
});

updateHealth(80);

function updateHealth(healthValue){
  console.log("Updating value");

  playerA.update(
    {
      "health":healthValue
    }
  )
}

// var playersRef = defaultDatabase.ref("moves/");
// playersRef.on("child_changed", function(data) {
//    var moveData = data.val();
//    console.log("Move number: " + moveData.moveNumber);
// });

</script>

</body>